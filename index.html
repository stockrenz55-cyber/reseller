<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Nyxo Panel Creator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Orbitron',sans-serif}
body{
  min-height:100vh;
  background:linear-gradient(rgba(0,0,0,.65),rgba(0,0,0,.85)),
  url("https://images.unsplash.com/photo-1535223289827-42f1e9919769");
  background-size:cover;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#fff;
}
.card{
  width:420px;
  padding:30px;
  backdrop-filter: blur(12px);
  background: rgba(255,255,255,.08);
  border-radius:18px;
  box-shadow:0 0 25px rgba(0,255,255,.3);
}
input,select,button{
  width:100%;
  padding:12px;
  margin:10px 0;
  background:transparent;
  border:1px solid #0ff;
  color:#fff;
}
button{cursor:pointer}
pre{white-space:pre-line;color:#0f0}
</style>
</head>

<body>

<div class="card">
  <h2>NYXO PANEL</h2>
  <input id="username" placeholder="Username Panel">
  <select id="paket">
    <option value="1gb">1 GB</option>
    <option value="2gb">2 GB</option>
    <option value="3gb">3 GB</option>
    <option value="4gb">4 GB</option>
    <option value="5gb">5 GB</option>
    <option value="unlimited">Unlimited</option>
  </select>
  <button onclick="buatPanel()">CREATE PANEL</button>
  <pre id="log"></pre>
</div>

<script>
/* ========= CONFIG ========= */
const CONFIG = {
  domain: "https://nyxostudio.web.id",

  // APPLICATION (ADMIN)
  apikey: "ptla_mIoA2uJSLrSVm0r3l21x2wTjQee9ZpCR5YjifRufQue",

  // CLIENT (USER)
  capikey: "ptlc_0nPji2uEXI9WuSU6mRmBwwyG8C1TV2yen0eTGkO52Vc",

  egg: 15,
  loc: 1
};

const MAP = {
  "1gb":{ram:1024,disk:1024,cpu:40},
  "2gb":{ram:2048,disk:2048,cpu:60},
  "3gb":{ram:3072,disk:2048,cpu:80},
  "4gb":{ram:4096,disk:2048,cpu:100},
  "5gb":{ram:5120,disk:3072,cpu:120},
  "unlimited":{ram:0,disk:0,cpu:0}
};

async function buatPanel(){
  const user = username.value.toLowerCase();
  if(!user) return alert("Username wajib diisi");
  const spec = MAP[paket.value];
  log.textContent = "‚è≥ Membuat user panel...";

  /* ===== CREATE USER ===== */
  const u = await fetch(CONFIG.domain+"/api/application/users",{
    method:"POST",
    headers:{
      "Authorization":"Bearer "+CONFIG.apikey,
      "Content-Type":"application/json"
    },
    body:JSON.stringify({
      email: user+"@panel.local",
      username: user,
      first_name: user,
      last_name: "server",
      password: user+"001"
    })
  });
  const uData = await u.json();
  if(!uData.attributes) throw new Error("Gagal create user");

  log.textContent += "\n‚è≥ Membuat server...";

  /* ===== CREATE SERVER ===== */
  const s = await fetch(CONFIG.domain+"/api/application/servers",{
    method:"POST",
    headers:{
      "Authorization":"Bearer "+CONFIG.apikey,
      "Content-Type":"application/json"
    },
    body:JSON.stringify({
      name: user+"-server",
      user: uData.attributes.id,
      egg: CONFIG.egg,
      docker_image: "ghcr.io/parkervcp/yolks:nodejs_18",
      startup: "npm start",
      limits: spec,
      feature_limits:{databases:0,allocations:1,backups:0},
      allocation:{default:1},
      deploy:{locations:[CONFIG.loc],dedicated_ip:false,port_range:[]}
    })
  });
  const sData = await s.json();
  if(!sData.attributes) throw new Error("Gagal create server");

  /* ===== TEST CAPIKEY (CLIENT API) ===== */
  log.textContent += "\nüîê Verifikasi Client API...";
  const c = await fetch(
    CONFIG.domain+"/api/client/servers/"+sData.attributes.identifier,
    {
      headers:{
        "Authorization":"Bearer "+CONFIG.capikey,
        "Accept":"application/json"
      }
    }
  );
  const cData = await c.json();

  log.textContent = `
‚úÖ PANEL BERHASIL

Username : ${user}
Password : ${user}001
RAM      : ${spec.ram==0?"Unlimited":spec.ram/1024+"GB"}
Disk     : ${spec.disk==0?"Unlimited":spec.disk/1024+"GB"}
CPU      : ${spec.cpu==0?"Unlimited":spec.cpu+"%"}
ServerID : ${sData.attributes.identifier}

Client API : ${cData.object ? "AKTIF ‚úÖ" : "GAGAL ‚ùå"}
Panel     : ${CONFIG.domain}
`;
}
</script>

</body>
</html>
